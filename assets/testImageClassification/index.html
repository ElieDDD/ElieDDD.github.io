<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
     
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/knn-classifier"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet"></script>
    
    <style>
    
      img {
        width:  400px;
        height: 250px;
      }
      
    </style>
    
   </head>
   <body>
     
     <img id="zebra1" src="zebra.jpg" />
     <img id="bird1"  src="bird.jpg" />
     <img id="bird2"  src="dove.jpg" />
     <img id="zebra2" src="zebra2.jpg" />
     <img id="test"   src="kingfisher.jpg" />
     
     <script>
     
       const run = async function() {
         
         console.log("training");
         
         const classifier = knnClassifier.create(); 
         
         const neuralNetwork = await mobilenet.load();
         
         const zebra1_img = tf.browser.fromPixels(document.getElementById("zebra1"));
         
         const zebra1_logits = neuralNetwork.infer(zebra1_img, "conv_preds");
         
         classifier.addExample(zebra1_logits, 0);
         
         const bird1_img = tf.browser.fromPixels(document.getElementById("bird1"));
         
         const bird1_logits = neuralNetwork.infer(bird1_img, "conv_preds");
         
         classifier.addExample(bird1_logits, 1);
         
         const bird2_img = tf.browser.fromPixels(document.getElementById("bird2"));
         
         const bird2_logits = neuralNetwork.infer(bird2_img, "conv_preds");
         
         classifier.addExample(bird2_logits, 1);
      
         const zebra2_img = tf.browser.fromPixels(document.getElementById("zebra2"));
         
         const zebra2_logits = neuralNetwork.infer(zebra2_img, "conv_preds");
         
         classifier.addExample(zebra2_logits, 0);
         
         const test_img = tf.browser.fromPixels(document.getElementById("test"));
         
         const test_logits = neuralNetwork.infer(test_img, "conv_preds");
         
         const prediction = await classifier.predictClass(test_logits);
         
         console.log(prediction);
         
       }
       
       run(); 
       
     </script>
     
   </body>
 </html>